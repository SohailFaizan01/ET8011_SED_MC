#################################### Main Choices ####################################

Amplifier Type:
 - Current to voltage. To avoid non-linearity of the input ESD protection (TVS Diode), a current input is required. The output is voltage as that will be read out by the spectrum analyser

Input/Output Impedances:
 - As the input type is current, the input impedance needs to approach 0 Ohm
 - In order to minimize reflections and maximize power transfer, 50 Ohm output impedance is required.

 	Implementation: The general controller will satisfy this if it has high enough gain, then it will act as an virtual ground.
 			Brute force for simplicity, it remains to be validated if this is an issue with noise requirements

Feedback Structure:
 - Passive integrating feedback structure, to compensate the differentiated input signal.
	Implementation: Capacitor 

Controller:
 - Two stage design in order to obtain enough loop gain, one stage does not have enough output impedance (50 Ohms). Furthermore, class AB output to reduce power consumption
	Options:
	 - Input
		- Cs stage: Inverting stage, will cause a positive feedback loop with the output stage :/
		- Cd stage: Does not have enough gain
		- Cg stage: Loads the input
		- Differential pair: Has gain and does not load the input, has higher noise.

	 - Output
		- Complementary Parallel: It has gain and low power
		- Antiparallel (Cs-Cd stage): not good because no gain and the first stage needs full swing, thus contributing to non linearity
 
	implementation: Differential input stage, with complementary parallel output stage

		Differential Input Stage:
			- NMOS instead of PMOS because it can be made smaller

Noise:
 - First stage is dominant in terms of noise as the noise of the second stage gets divided by the gain of the first stage.
 - Increase W of S1 until noise spec is met. Current should be increased to maintain IC, and thereby Ft.


Drive Capability:
 - First stage drive capability is equal to the gate current of the second stage.

 - Second stage determines the main drive capability as it is connected directly to the output.
 - 1mW into 50 Ohms => 0.2236V This is doubled to account for  50 Ohms output impedance => 0.4472V => 4,5 mA drive capability


Transfer:
 - Input = max 0.25V , Output = max 0,4472V => Gain = 1.788 => Cfb = 0.56*Cs
 - Vo = 2*(P*R)^0.5


Distortion/Non Linearity:


Biasing:

#################################### Order of Design ####################################
 - Set quiescent current to meet bandwidth requirement, the bandwidth varies with signal amplitude, the quiescent yields the minimum bandwidth. Non linearity might require more current still.
 - Input stage current should meet the bandwidth of the second stage to ensure stability.















#################################### Others ####################################

 - Loop gain reference selection: Set Cd to 0 
 - Current for stage 1 is determined by the noise spec, current for the second stage is determined by non linearity and drive capability


#################################### Questions for Anton ####################################
 
 - How to size the output transistors
 - Cascode a cg to the input pair


#################################### To-Do ####################################

 - Add loopgain of previous design
 - Fix frequency compensation
 - Make design choices page pretty.

#################################### General Questions ####################################

 - Which stage is responsible for which pole in the loopgain graph?



#################################### Frequency Compensation ####################################
 - Phantom zero: not possible due to capacitive feedback
 - Pole Splitting /  / Resistive broad banding, will only move the poles further apart



#################################### To-Do ####################################
 - Dominant pole is set by the capacitance second stage, cascoding will this time increase the bandwidth!
 - Set bandwidth, non linearity requirement through the current and width in the second stage
 - Set noise and gain though the width in the first stage and make sure there is enough current to drive the second stage, ie bandwidth greater or equal to the second stage.

























@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
13/02/26

First Stage => noise optimization: small device, L always smallest, scale W based on gm. ensuring highest possible inversion level (upto IC_Crit, after that gm does not significantly increase) 

Maybe IC_Crit is not required and a trade off can be made for absolute noise performance and less power consumption 

find IC_Crit (Id/W) increase Id until gm hits IC_Crit - Scale W until noise performance is obtained. 


Equations:

 - Bandwidth 	= gm 1st & Ciss 2nd
 - Noise 	= gm 1st & Ciss 1st
 - Gain 2nd 	= gm 2nd * 100 Ohm
 - Gain 1st 	= gm 1st * Rout 1st


 Find IC_crit - obtain minimum gm whilst meeting noise spec (decreasing w which whilst keeping IC the same will increase noise)
 Size the second stage Ciss to the biggest W that still meets the bandwidth 	<^-^>
 determine the Id of the 2nd stage by setting the gm target. 			needs adjusting


@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
17/02/26

Set noise budget to first stage
loop whole circuit to find optimum IC for the first stage
 